System.register([],function(_){"use strict";return{execute:function(){_("atom",P);let N=0;function P(t,s){const d=`atom${++N}`,m={toString:()=>d};return typeof t=="function"?m.read=t:(m.init=t,m.read=R,m.write=T),s&&(m.write=s),m}function R(t){return t(this)}function T(t,s,d){return s(this,typeof d=="function"?d(t(this)):d)}const B=(t,s)=>t.unstable_is?t.unstable_is(s):s===t,F=t=>"init"in t,G=t=>!!t.write,M=Symbol(""),C="pending",U="fulfilled",$="rejected",x=t=>typeof t=="object"&&t!==null&&M in t,D=new WeakMap,K=(t,s,d)=>{if(!D.has(t)){let m;const w=new Promise((j,q)=>{let g=t;const z=v=>p=>{g===v&&(w.status=U,w.value=p,j(p),d())},b=v=>p=>{g===v&&(w.status=$,w.reason=p,q(p),d())};t.then(z(t),b(t)),m=(v,p)=>{v&&(D.set(v,w),g=v,v.then(z(v),b(v))),s(),s=p}});w.status=C,w[M]=m,D.set(t,w)}return D.get(t)},Q=t=>typeof(t==null?void 0:t.then)=="function",H=t=>"v"in t||"e"in t,O=t=>{if("e"in t)throw t.e;return t.v},W=t=>{const s=t.v;return x(s)&&s.status===C?s:null},I=(t,s,d)=>{d.p.has(t)||(d.p.add(t),s.then(()=>{d.p.delete(t)},()=>{d.p.delete(t)}))},E=()=>[new Map,new Map,new Set],J=(t,s,d)=>{t[0].has(s)||t[0].set(s,new Set),t[1].set(s,d)},X=(t,s,d)=>{const m=t[0].get(s);m&&m.add(d)},Y=(t,s)=>t[0].get(s),L=(t,s)=>{t[2].add(s)},y=t=>{for(;t[1].size||t[2].size;){t[0].clear();const s=new Set(t[1].values());t[1].clear();const d=new Set(t[2]);t[2].clear(),s.forEach(m=>{var w;return(w=m.m)==null?void 0:w.l.forEach(j=>j())}),d.forEach(m=>m())}},Z=_("createStore",()=>{const t=new WeakMap,s=r=>{let e=t.get(r);return e||(e={d:new Map,p:new Set,n:0},t.set(r,e)),e},d=(r,e,n,o=()=>{},u=()=>{})=>{const l="v"in e,a=e.v,h=W(e);if(Q(n))if(h)h!==n&&(h[M](n,o),++e.n);else{const i=K(n,o,u);if(i.status===C)for(const c of e.d.keys()){const f=s(c);I(r,i,f)}e.v=i,delete e.e}else h&&h[M](Promise.resolve(n),o),e.v=n,delete e.e;(!l||!Object.is(a,e.v))&&++e.n},m=(r,e,n,o)=>{var u;const l=s(e);l.d.set(n,o.n);const a=W(l);a&&I(e,a,o),(u=o.m)==null||u.t.add(e),r&&X(r,n,e)},w=(r,e,n)=>{const o=s(e);if(!(n!=null&&n(e))&&H(o)&&(o.m||Array.from(o.d).every(([c,f])=>w(r,c,n).n===f)))return o;o.d.clear();let u=!0;const l=c=>{if(B(e,c)){const S=s(c);if(!H(S))if(F(c))d(c,S,c.init);else throw new Error("no atom init");return O(S)}const f=w(r,c,n);if(u)m(r,e,c,f);else{const S=E();m(S,e,c,f),b(S,e,o),y(S)}return O(f)};let a,h;const i={get signal(){return a||(a=new AbortController),a.signal},get setSelf(){return!h&&G(e)&&(h=(...c)=>{if(!u)return z(e,...c)}),h}};try{const c=e.read(l,i);return d(e,o,c,()=>a==null?void 0:a.abort(),()=>{if(o.m){const f=E();b(f,e,o),y(f)}}),o}catch(c){return delete o.v,o.e=c,++o.n,o}finally{u=!1}},j=r=>O(w(void 0,r)),q=(r,e)=>{const n=i=>{var c,f;const S=s(i),k=new Set((c=S.m)==null?void 0:c.t);for(const A of S.p)k.add(A);return(f=Y(r,i))==null||f.forEach(A=>{k.add(A)}),k},o=[],u=new Set,l=i=>{if(!u.has(i)){u.add(i);for(const c of n(i))i!==c&&l(c);o.push(i)}};l(e);const a=new Set([e]),h=i=>u.has(i);for(let i=o.length-1;i>=0;--i){const c=o[i],f=s(c),S=f.n;let k=!1;for(const A of f.d.keys())if(A!==c&&a.has(A)){k=!0;break}k&&(w(r,c,h),b(r,c,f),S!==f.n&&(J(r,c,f),a.add(c))),u.delete(c)}},g=(r,e,...n)=>{const o=l=>O(w(r,l)),u=(l,...a)=>{let h;if(B(e,l)){if(!F(l))throw new Error("atom not writable");const i=s(l),c="v"in i,f=i.v,S=a[0];d(l,i,S),b(r,l,i),(!c||!Object.is(f,i.v))&&(J(r,l,i),q(r,l))}else h=g(r,l,...a);return y(r),h};return e.write(o,u,...n)},z=(r,...e)=>{const n=E(),o=g(n,r,...e);return y(n),o},b=(r,e,n)=>{if(n.m&&!W(n)){for(const o of n.d.keys())n.m.d.has(o)||(v(r,o).t.add(e),n.m.d.add(o));for(const o of n.m.d||[])if(!n.d.has(o)){const u=p(r,o);u==null||u.t.delete(e),n.m.d.delete(o)}}},v=(r,e)=>{const n=s(e);if(!n.m){w(r,e);for(const o of n.d.keys())v(r,o).t.add(e);if(n.m={l:new Set,d:new Set(n.d.keys()),t:new Set},G(e)&&e.onMount){const o=n.m,{onMount:u}=e;L(r,()=>{const l=u((...a)=>g(r,e,...a));l&&(o.u=l)})}}return n.m},p=(r,e)=>{const n=s(e);if(n.m&&!n.m.l.size&&!Array.from(n.m.t).some(o=>s(o).m)){const o=n.m.u;o&&L(r,o),delete n.m;for(const l of n.d.keys()){const a=p(r,l);a==null||a.t.delete(e)}const u=W(n);u&&u[M](void 0,()=>{});return}return n.m};return{get:j,set:z,sub:(r,e)=>{const n=E(),o=v(n,r);y(n);const u=o.l;return u.add(e),()=>{u.delete(e);const l=E();p(l,r),y(l)}}}});let V;const tt=_("getDefaultStore",()=>(V||(V=Z()),V))}}});
